import Beta from '../../components/beta'
import { Callout } from 'nextra/components';

<Beta/>

# Managing MVR names (mainnet only)

<Callout type="warning">
    These examples assume that you use the Typescript Plugin, as described in the  [`Typescript SDK`](/move-registry/tooling/typescript-sdk) section.
</Callout>

## Creating a new application

To create a new application, you need to present a SuiNS name and a package name, as long as it is not 
already registered.

```typescript
const transaction = new Transaction();

const appCap = transaction.moveCall({
    target: `@mvr/core::move_registry::register`,
    arguments: [
        // the registry obj: Can also be resolved as `registry-obj@mvr` from mainnet SuiNS.
        transaction.object('0x0e5d473a055b6b7d014af557a13ad9075157fdc19b6d51562a18511afd397727'),
        transaction.object(suinsObjectId),
        transaction.pure.string(name),
        transaction.object.clock(),
    ],
});

// we can then use the appCap to attach packages directly, or transfer (e.g. to a safe address)
// and register packages later.
```

## Attaching a mainnet package to an application

When attaching a mainnet package to an application, we need to present the `PackageInfo` object directly.
This call is permanent, and cannot be undone. Once a `PackageInfo` is attached to an application, it cannot be 
detached in the future. So an app is always linked to a specific package.

```typescript
// we can then use the appCap to attach packages directly, or transfer (e.g. to a safe address)
// and register packages later.

const transaction = new Transaction();

 transaction.moveCall({
    target: `@mvr/core::move_registry::assign_package`,
    arguments: [
        // the registry obj: Can also be resolved as `registry-obj@mvr` from mainnet SuiNS.
        transaction.object(`0x0e5d473a055b6b7d014af557a13ad9075157fdc19b6d51562a18511afd397727`),
        transaction.object('<The AppCap object>'),
        transaction.object('<The PackageInfo object on mainnet>'),
    ],
});
```

## Attaching a non-mainnet package to an application

For non-mainnet networks, we only attach a "pointer" to the package, instead of strict-binding (which wouldn't be possible).

> Note: You can always update an external network by first calling `@mvr/core::move_registry::unset_network`, and then calling `@mvr/core::move_registry::set_network` again.

```typescript
const transaction = new Transaction();

const appInfo = transaction.moveCall({
    target: `@mvr/core::app_info::new`,
    arguments: [
        transaction.pure.option("address", '<The objectId of the `PackageInfo` object on the external network>'),
        transaction.pure.option("address", '<The address of the package on the external network>'),
        transaction.pure.option("address", null),
    ],
});

transaction.moveCall({
    target: `@mvr/core::move_registry::set_network`,
    arguments: [
        // the registry obj: Can also be resolved as `registry-obj@mvr` from mainnet SuiNS.
        transaction.object('0x0e5d473a055b6b7d014af557a13ad9075157fdc19b6d51562a18511afd397727'),
        transaction.object('<The AppCap object>'),
        transaction.pure.string("<chain id of the network: use `4c78adac` for testnet>"),
        appInfo,
    ],
});
```
